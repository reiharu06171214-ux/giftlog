{% extends "base.html" %}
{% block content %}
  <div class="card">
    <h2>ギフト編集</h2>

    <form method="post" class="grid cols-2">
      <!-- タイトル & 受領日 -->
      <div class="form-group">
        <label for="title">タイトル*</label>
        <input id="title" name="title" value="{{ gift.title }}" required autofocus
               autocomplete="off" inputmode="text">
      </div>

      <div class="form-group">
        <label for="received_date">受領日</label>
        <input id="received_date" name="received_date" type="date"
               value="{{ gift.received_date|datejp }}" autocomplete="bday">
      </div>

      <!-- 金額 & 贈り主 -->
      <div class="form-group">
        <label for="amount_yen">金額（円・任意）</label>
        <input id="amount_yen" name="amount_yen" type="number" min="0" step="1"
               value="{{ gift.amount_yen if gift.amount_yen is not none else '' }}"
               inputmode="numeric" autocomplete="off"
               aria-describedby="hint-amount">
        <span id="hint-amount" class="small">※ 半角数字。未入力でもOKだよ</span>
      </div>

      <div class="form-group">
        <label for="giver_id">贈り主</label>
        <select id="giver_id" name="giver_id">
          <option value="">（未選択）</option>
          {% for g in givers %}
            <option value="{{ g.id }}" {% if gift.giver_id == g.id %}selected{% endif %}>{{ g.name }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- カテゴリ & 返礼期日 -->
      <div class="form-group">
        <label for="category_id">カテゴリ</label>
        <select id="category_id" name="category_id">
          <option value="">（未選択）</option>
          {% for c in categories %}
            <option value="{{ c.id }}" {% if gift.category_id == c.id %}selected{% endif %}>{{ c.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <label for="return_due_date">返礼ToDo期日</label>
        <input id="return_due_date" name="return_due_date" type="date"
               value="{{ gift.return_due_date|datejp }}" aria-describedby="hint-return">
        <span id="hint-return" class="small">※ カレンダー出力に使われます</span>
      </div>

      <!-- チェック類 -->
      <div class="checks-row span-2">
        <label class="check">
          <input type="checkbox" name="thank_you_sent" {% if gift.thank_you_sent %}checked{% endif %}>
          ありがとう連絡 済
        </label>
        <label class="check">
          <input type="checkbox" name="return_done" {% if gift.return_done %}checked{% endif %}>
          お返しOK 済
        </label>
      </div>

      <!-- メモ -->
      <div class="form-group span-2">
        <label for="memo">メモ</label>
        <textarea id="memo" name="memo" rows="4" placeholder="メモを入力">{{ gift.memo }}</textarea>
      </div>

      <!-- ボタン -->
      <div class="form-actions span-2">
        <button class="btn btn-search" type="submit">更新</button>
        <a class="btn" href="{{ url_for('gifts') }}">← 一覧へ戻る</a>
      </div>
    </form>
  </div>
{% endblock %}
